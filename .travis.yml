language: c++
sudo: required
env:
  global:
    # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
    #   via the "travis encrypt" command using the project repo's public key
    - secure: DtUVE6s2m9CvYw1leYGs37tCxKwYSZt+GqujZSh3gHR5L3KlbFzmov47ZUP68H3DSbJszrnE4L0tHgiQajJJrdjJY0WtC59wHaJkO/VtfI0qMcBQIIcqxhHId5us/eAWMig5G9Y6bHnUHeug594fWlXaVnH6wg9EX0mKlGnsaeyW+J2JvdTAzTEx3m3UMd9gd8jnCLSd6Uv8tc+G4wgmmLM0cnhVHgylAPD3RNAkGgPyNd/N04YMh0F/NvLd87ta/WpBs+ovf6Olzwf7DAgX32xZTsur57XpkC+3QnJRNXs5YavV6NIl6F4JimB5jN1fVj8muFYnIVnBGJ+/71/5AtTun/uQrM4CPj5wAjFMiDXjkAvtkGPdFqwOXDKB06XR2td9xLFiwWGGeiR7tUykKCDN6o3lBlo6uBlEFwgmpJmdUH1+6vXQ50OIk+J43wv3W4/smCaWuchymlbg1FDlgPvi7WSzjaJSuUi6zfrP88K+bw+4EZ1jmv9t9XGk4Rbktg72uWF+y6Bbip+k0u/TXHsPE2bz7ZEtKSyoEgQk/Gm9Yje5sluH4eXcaM/6HSy3vpQh9KkbQdKtff21kiKWYmkXa7kppTi3XC/6JqfkMuUONPn7ck0zb+fpVKQ6aPxbdsXuhn8cHNsgNsWTX5ihPBLrggvg0tcu0jHR0/tUIh0=


matrix:
  include:

   ## ###### Ubuntu Linux ####################################################

   ## ====== Ubuntu 19.10 (Eoan Ermine) ======================================
   #- name: "Ubuntu 19.10 (Eoan Ermine) with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:eoan" VARIANT="ubuntu" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   #- name: "Ubuntu 19.10 (Eoan Ermine) with Clang"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:eoan" VARIANT="ubuntu" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Ubuntu 19.10 (Eoan Ermine) packaging with pbuilder"
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:eoan" VARIANT="ubuntu" TOOL="pbuilder"

   ## ====== Ubuntu 19.04 (Disco Dingo) ======================================
   #- name: "Ubuntu 19.04 (Disco Dingo) with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:disco" VARIANT="ubuntu" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ##- name: "Ubuntu 19.04 (Disco Dingo) with Clang"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="ubuntu:disco" VARIANT="ubuntu" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Ubuntu 19.04 (Disco Dingo) packaging with pbuilder"
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:disco" VARIANT="ubuntu" TOOL="pbuilder"

   ## ====== Ubuntu 18.04 (Bionic Beaver) ====================================
   #- name: "Ubuntu 18.04 (Bionic Beaver) with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:bionic" VARIANT="ubuntu" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ##- name: "Ubuntu 18.04 (Bionic Beaver) with Clang"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="ubuntu:bionic" VARIANT="ubuntu" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Ubuntu 18.04 (Bionic Beaver) packaging with pbuilder"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:bionic" VARIANT="ubuntu" TOOL="pbuilder"

   ## ====== Ubuntu 16.04 (Xenial Xerus) =====================================
   #- name: "Ubuntu 16.04 (Xenial Xerus) with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:xenial" VARIANT="ubuntu" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ##- name: "Ubuntu 16.04 (Xenial Xerus) with Clang"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="ubuntu:xenial" VARIANT="ubuntu" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Ubuntu 16.04 (Xenial Xerus) packaging with pbuilder"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="ubuntu:xenial" VARIANT="ubuntu" TOOL="pbuilder"


   ## ###### Fedora Linux ###################################################

   ### ====== Fedora 31 =======================================================
   ##- name: "Fedora 31 with GCC"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="fedora:31" VARIANT="fedora" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ###- name: "Fedora 31 with Clang"
     ###os: linux
     ###dist: bionic
     ###group: travis_latest
     ###env: DOCKER="fedora:31" VARIANT="fedora" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   ##- name: "Fedora 31 packaging with mock"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="fedora:31" VARIANT="fedora" TOOL="mock"

   ## ====== Fedora 30 =======================================================
   #- name: "Fedora 30 with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="fedora:30" VARIANT="fedora" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ##- name: "Fedora 30 with Clang"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="fedora:30" VARIANT="fedora" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Fedora 30 packaging with mock"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="fedora:30" VARIANT="fedora" TOOL="mock"

   ## ====== Fedora 29 =======================================================
   #- name: "Fedora 29 with GCC"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="fedora:29" VARIANT="fedora" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ##- name: "Fedora 29 with Clang"
     ##os: linux
     ##dist: bionic
     ##group: travis_latest
     ##env: DOCKER="fedora:29" VARIANT="fedora" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   #- name: "Fedora 29 packaging with mock"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: DOCKER="fedora:29" VARIANT="fedora" TOOL="mock"

   ## ====== Fedora Rawhide ==================================================
   ## - name: "Fedora Rawhide with GCC"
   ##   os: linux
   ##   dist: bionic
   ##   group: travis_latest
   ##   env: DOCKER="fedora:rawhide" VARIANT="fedora" TOOL="compile" COMPILER_C="gcc" COMPILER_CXX="g++"
   ## - name: "Fedora Rawhide with Clang"
   ##   os: linux
   ##   dist: bionic
   ##   group: travis_latest
   ##   env: DOCKER="fedora:rawhide" VARIANT="fedora" TOOL="compile" COMPILER_C="clang" COMPILER_CXX="clang++"
   ## - name: "Fedora Rawhide packaging with mock"
   ##   os: linux
   ##   dist: bionic
   ##   group: travis_latest
   ##   env: DOCKER="fedora:rawhide" VARIANT="fedora" TOOL="mock"


   ## ###### Other ###########################################################

   ## ====== MacOS X ========================================================
   ## - name: "MacOS X"
   ##   os: osx
   ##   osx_image: xcode9.4
   ##   compiler: clang
   ##   group: travis_latest


   ## ###### Special #########################################################

   #- name: "Default Build"
     #os: linux
     #dist: bionic
     #group: travis_latest
     #env: TOOL="compile"

   - name: "Coverity Scan"
     os: linux
     dist: bionic
     group: travis_latest
     env:
      - TOOL="coverity"
      - VARIANT="ubuntu"
      - COVERITY_PROJECT="dreibh%2Fatlasmns-trace-TESTONLY"
      - COVERITY_SCAN_NOTIFICATION_EMAIL="dreibh@simula.no"
      - COVERITY_SCAN_BRANCH="coverity_scan"


before_install:
  - ci/before-install

install:
  - ci/install

script:
  - ci/build
  - |
    if [ "${VARIANT}" != "debian" ] ; then   # There is no Debian PPA for the required rsplib-* packages!
       ci/test
    fi
